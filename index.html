<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>🪄 AI 캐릭터 포즈 생성기 v4.1</title>
  <style>
    body{
      margin:0;
      background:#ffffff;
      color:#333;
      font-family:'Noto Sans KR',system-ui,sans-serif;
      text-align:center;
    }
    canvas{
      background:transparent;
      width:512px;
      height:512px;
      margin:16px;
      border-radius:12px;
      border:1px solid #ccc;
    }
    select,input,button{
      margin:6px;
      padding:8px;
      border-radius:8px;
      border:1px solid #aaa;
      background:#f7f7f7;
      color:#222;
      font-weight:500;
    }
    button{
      cursor:pointer;
      background:linear-gradient(180deg,#06b6d4,#0284c7);
      border:none;
      color:#fff;
      font-weight:700;
    }
    .wrap{max-width:1100px;margin:auto;padding:16px}
    .ctl{display:flex;flex-wrap:wrap;justify-content:center;gap:8px;margin-bottom:8px}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>🧍 AI 캐릭터 포즈 생성기 v4.1</h1>
    <p style="color:#555;font-size:14px;margin-top:-6px;">밝은 배경에서 캐릭터 라인드로잉이 선명하게 표시됩니다.</p>

    <div class="ctl">
      <label>머리형</label>
      <select id="headType">
        <option>곰돌이</option><option>고양이</option><option>강아지</option>
        <option>펭귄</option><option>오리</option><option>기린</option>
        <option>카피바라</option><option>양갈래머리 여자</option>
        <option>스포츠머리 남자</option><option>긴머리 여성</option>
      </select>
      <label>표정</label>
      <select id="faceType">
        <option>웃음</option><option>울음</option><option>하트눈</option><option>별눈</option>
        <option>선글라스</option><option>분노</option><option>코믹</option>
        <option>해골</option><option>X눈</option><option>생각</option>
      </select>
      <label>선 스타일</label>
      <select id="lineStyle">
        <option value="normal">기본</option>
        <option value="wobbly">찌글찌글</option>
        <option value="pixel">픽셀</option>
        <option value="fuzzy">복실복실</option>
      </select>
      <label>선두께</label>
      <input type="range" id="lw" min="8" max="24" value="12"/>
      <label>팔 각도</label><input type="range" id="armAngle" min="-180" max="180" value="0"/>
      <label>다리 각도</label><input type="range" id="legAngle" min="0" max="360" value="30"/>
      <label>몸 기울기</label><input type="range" id="bodyTilt" min="-45" max="45" value="0"/>
      <label>머리 기울기</label><input type="range" id="headTilt" min="-45" max="45" value="0"/>
    </div>
    <button id="saveBtn">PNG 저장</button>
    <canvas id="cv" width="1024" height="1024"></canvas>
  </div>

  <script>
  const cv=document.getElementById("cv"),ctx=cv.getContext("2d");
  const $=id=>document.getElementById(id);
  function deg2rad(d){return d*Math.PI/180;}

  function applyLineStyle(style){
    ctx.setLineDash([]);ctx.lineJoin='round';ctx.lineCap='round';
    ctx.imageSmoothingEnabled=true;
    if(style==="pixel"){ctx.imageSmoothingEnabled=false;}
  }

  function strokePath(style, drawFn){
    if(style==='wobbly'){
      for(let i=0;i<2;i++){ctx.save();ctx.translate(Math.random()*2-1,Math.random()*2-1);drawFn();ctx.stroke();ctx.restore();}
    }else if(style==='fuzzy'){
      for(let i=0;i<5;i++){ctx.save();ctx.translate(Math.random()*2-1,Math.random()*2-1);ctx.globalAlpha=0.25;drawFn();ctx.stroke();ctx.restore();}
      ctx.globalAlpha=1;
    }else{drawFn();ctx.stroke();}
  }

  function drawHeadShape(type,r){
    ctx.beginPath();
    if(type==='곰돌이'){
      ctx.arc(-r*0.6,-r*0.7,r*0.3,0,Math.PI*2);
      ctx.arc(r*0.6,-r*0.7,r*0.3,0,Math.PI*2);
    }
    ctx.beginPath();
    if(['곰돌이','카피바라','강아지','고양이'].includes(type))
      ctx.ellipse(0,0,r*1.1,r*1.0,0,0,Math.PI*2);
    if(type==='펭귄') ctx.ellipse(0,0,r*1.0,r*1.2,0,0,Math.PI*2);
    if(type==='기린'){ctx.ellipse(0,0,r*0.9,r*1.3,0,0,Math.PI*2);
      ctx.moveTo(-r*0.3,-r*1.3);ctx.lineTo(-r*0.2,-r*1.6);
      ctx.moveTo(r*0.3,-r*1.3);ctx.lineTo(r*0.2,-r*1.6);}
    if(type==='오리'){ctx.ellipse(0,0,r*1.0,r*0.9,0,0,Math.PI*2);
      ctx.moveTo(-r*0.4,r*0.4);ctx.quadraticCurveTo(0,r*0.7,r*0.4,r*0.4);}
    if(type==='양갈래머리 여자'){ctx.ellipse(0,0,r*1.0,r*1.0,0,0,Math.PI*2);
      ctx.arc(-r*0.9,-r*0.6,r*0.3,0,Math.PI*2);
      ctx.arc(r*0.9,-r*0.6,r*0.3,0,Math.PI*2);}
    if(type==='스포츠머리 남자'){ctx.moveTo(-r,0);ctx.quadraticCurveTo(0,-r*1.2,r,0);ctx.lineTo(-r,0);}
    if(type==='긴머리 여성'){ctx.moveTo(-r,0);ctx.quadraticCurveTo(-r*1.1,r*1.5,0,r*1.6);
      ctx.quadraticCurveTo(r*1.1,r*1.5,r,0);}
    ctx.stroke();
  }

  function drawFace(type,r){
    ctx.beginPath();
    if(type==='웃음'){ctx.arc(0,r*0.2,r*0.3,0,Math.PI,false);}
    if(type==='울음'){ctx.moveTo(-r*0.1,-r*0.1);ctx.lineTo(-r*0.1,r*0.3);ctx.moveTo(r*0.1,-r*0.1);ctx.lineTo(r*0.1,r*0.3);}
    if(type==='하트눈'){ctx.moveTo(-r*0.3,-r*0.3);ctx.bezierCurveTo(-r*0.45,-r*0.5,-r*0.1,-r*0.6,-r*0.3,-r*0.3);
                        ctx.moveTo(r*0.3,-r*0.3);ctx.bezierCurveTo(r*0.45,-r*0.5,r*0.1,-r*0.6,r*0.3,-r*0.3);}
    if(type==='별눈'){for(let side of[-1,1]){ctx.save();ctx.translate(side*r*0.2,-r*0.2);
      for(let i=0;i<5;i++){ctx.lineTo(Math.cos((18+i*72)*Math.PI/180)*r*0.15,Math.sin((18+i*72)*Math.PI/180)*r*0.15);}ctx.restore();}}
    if(type==='선글라스'){ctx.rect(-r*0.4,-r*0.2,r*0.25,r*0.15);ctx.rect(r*0.15,-r*0.2,r*0.25,r*0.15);}
    if(type==='분노'){ctx.moveTo(-r*0.2,-r*0.3);ctx.lineTo(-r*0.1,-r*0.2);ctx.moveTo(r*0.2,-r*0.3);ctx.lineTo(r*0.1,-r*0.2);}
    if(type==='코믹'){ctx.moveTo(-r*0.1,0);ctx.lineTo(r*0.1,0);ctx.moveTo(0,0);ctx.lineTo(0,r*0.2);}
    if(type==='해골'){ctx.arc(0,0,r*0.3,0,Math.PI*2);for(let i=-2;i<=2;i++){ctx.moveTo(i*r*0.05,r*0.3);ctx.lineTo(i*r*0.05,r*0.35);}}
    if(type==='X눈'){ctx.moveTo(-r*0.3,-r*0.2);ctx.lineTo(-r*0.1,0);ctx.moveTo(-r*0.1,-r*0.2);ctx.lineTo(-r*0.3,0);
                     ctx.moveTo(r*0.3,-r*0.2);ctx.lineTo(r*0.1,0);ctx.moveTo(r*0.1,-r*0.2);ctx.lineTo(r*0.3,0);}
    if(type==='생각'){ctx.arc(-r*0.2,-r*0.2,r*0.05,0,Math.PI*2);ctx.arc(r*0.2,-r*0.2,r*0.05,0,Math.PI*2);}
    ctx.stroke();
  }

  function drawBody(lw,armA,legA,bodyTilt,headTilt,headR,style){
    ctx.clearRect(0,0,cv.width,cv.height);
    applyLineStyle(style);
    ctx.lineWidth=lw;ctx.strokeStyle='#000';
    const cx=512,cy=580;
    const bodyR=headR;
    ctx.save();ctx.translate(cx,cy);ctx.rotate(deg2rad(bodyTilt));
    strokePath(style,()=>{ctx.beginPath();ctx.ellipse(0,0,bodyR*0.8,bodyR*1.0,0,0,Math.PI*2);});
    drawLimb(-bodyR*0.8,-bodyR*0.2,armA,-1,bodyR,style);
    drawLimb(bodyR*0.8,-bodyR*0.2,-armA,1,bodyR,style);
    drawLeg(-bodyR*0.4,bodyR*0.9,legA,-1,bodyR,style);
    drawLeg(bodyR*0.4,bodyR*0.9,legA,1,bodyR,style);
    ctx.restore();
    ctx.save();ctx.translate(cx,cy-bodyR*1.3);ctx.rotate(deg2rad(headTilt));
    strokePath(style,()=>drawHeadShape($('headType').value,headR));
    drawFace($('faceType').value,headR);
    ctx.restore();
  }

  function drawLimb(x,y,angle,dir,r,style){
    ctx.save();ctx.translate(x,y);ctx.rotate(deg2rad(angle)*dir);
    strokePath(style,()=>{ctx.beginPath();ctx.moveTo(0,0);ctx.quadraticCurveTo(dir*r*0.3,r*0.3,dir*r*0.5,r*0.9);ctx.quadraticCurveTo(dir*r*0.25,r*0.5,0,0);});
    ctx.restore();
  }

  function drawLeg(x,y,angle,dir,r,style){
    ctx.save();ctx.translate(x,y);ctx.rotate(deg2rad(angle)*dir);
    strokePath(style,()=>{ctx.beginPath();ctx.moveTo(0,0);ctx.quadraticCurveTo(dir*r*0.3,r*0.4,dir*r*0.1,r*0.9);ctx.quadraticCurveTo(dir*r*0.2,r*0.6,0,0);});
    ctx.restore();
  }

  function randomName(){
    const heads=['bear','cat','dog','penguin','duck','giraffe','capybara','twintail','shortman','longhair'];
    const faces=['smile','cry','heart','star','sunglass','angry','comic','skull','xeye','think'];
    return heads[Math.floor(Math.random()*heads.length)]+'_'+faces[Math.floor(Math.random()*faces.length)]+'_pose.png';
  }

  function drawAll(){
    drawBody(parseInt($('lw').value),parseFloat($('armAngle').value),parseFloat($('legAngle').value),
      parseFloat($('bodyTilt').value),parseFloat($('headTilt').value),180,$('lineStyle').value);
  }

  ['lw','armAngle','legAngle','bodyTilt','headTilt','headType','faceType','lineStyle'].forEach(id=>{
    $(id).addEventListener('input',drawAll);
  });

  $('saveBtn').onclick=()=>{
    drawAll();
    const a=document.createElement('a');
    a.href=cv.toDataURL('image/png');
    a.download=randomName();
    a.click();
  };

  drawAll();
  </script>
</body>
</html>
