<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<title>AI 캐릭터 포즈 생성기 v9.5</title>
<style>
body{
  margin:0;
  background:#fdfdfd;
  color:#222;
  font-family:"Noto Sans KR",sans-serif;
  text-align:center;
}
canvas{
  width:512px;height:512px;
  background:transparent;
  border:1px solid #ccc;border-radius:12px;margin:10px;
}
.controls{display:flex;flex-wrap:wrap;justify-content:center;gap:10px;margin:10px;}
label{font-size:13px;}
select,input[type=range]{margin:4px;padding:4px;border-radius:6px;}
button{padding:8px 12px;border-radius:8px;border:none;background:#06b6d4;color:#fff;font-weight:700;cursor:pointer;}
</style>
</head>
<body>
<h1>🧍 AI 캐릭터 포즈 생성기 v9.5</h1>
<div class="controls">
  <label>등신
    <select id="ratio">
      <option value="1">1등신</option>
      <option value="1.5">1.5등신</option>
      <option value="2">2등신</option>
      <option value="2.5">2.5등신</option>
      <option value="3">3등신</option>
    </select>
  </label>
  <label>투시 강도
    <input type="range" id="persp" min="0.1" max="0.6" step="0.05" value="0.35">
  </label>
  <label>시점
    <select id="view">
      <option value="front">정면</option>
      <option value="top">위</option>
      <option value="bottom">아래</option>
      <option value="left">왼쪽</option>
      <option value="right">오른쪽</option>
    </select>
  </label>
  <label>왼팔 각도<input type="range" id="lArm" min="-180" max="180" value="-20"></label>
  <label>오른팔 각도<input type="range" id="rArm" min="-180" max="180" value="20"></label>
  <label>왼다리 각도<input type="range" id="lLeg" min="-180" max="180" value="10"></label>
  <label>오른다리 각도<input type="range" id="rLeg" min="-180" max="180" value="-10"></label>
  <label>머리 기울기<input type="range" id="headTilt" min="-45" max="45" value="0"></label>
  <label>몸 기울기<input type="range" id="bodyTilt" min="-45" max="45" value="0"></label>
  <label>선 두께<input type="range" id="lw" min="6" max="24" value="12"></label>
  <label>속도<input type="range" id="speed" min="0.2" max="3" step="0.1" value="1"></label>
</div>
<div>
  <button id="rotateBtn">360° 회전 ▶</button>
  <button id="saveBtn">PNG 저장</button>
</div>
<canvas id="cv" width="1024" height="1024"></canvas>

<script>
const cv=document.getElementById("cv"),ctx=cv.getContext("2d");
const $=id=>document.getElementById(id);

function deg(d){return d*Math.PI/180;}
function rnd(n){return Math.random()*n;}

function drawCharacter(){
  const ratio=parseFloat($('ratio').value);
  const lw=parseFloat($('lw').value);
  const persp=parseFloat($('persp').value);
  const view=$('view').value;
  const lArm=parseFloat($('lArm').value);
  const rArm=parseFloat($('rArm').value);
  const lLeg=parseFloat($('lLeg').value);
  const rLeg=parseFloat($('rLeg').value);
  const headTilt=parseFloat($('headTilt').value);
  const bodyTilt=parseFloat($('bodyTilt').value);
  const headRatio={1:1,1.5:1.3,2:1.7,2.5:2.1,3:2.5}[ratio];
  const base=180;
  ctx.clearRect(0,0,cv.width,cv.height);
  ctx.save();
  ctx.translate(512,600);
  ctx.lineWidth=lw;
  ctx.strokeStyle="#000";
  ctx.lineCap="round";
  ctx.lineJoin="round";
  // pseudo 3D
  if(view==="top") ctx.transform(1, -persp, 0, 1-persp, 0, 100);
  if(view==="bottom") ctx.transform(1, persp, 0, 1+persp, 0, -100);
  if(view==="left") ctx.transform(1-persp, 0, 0, 1, 100, 0);
  if(view==="right") ctx.transform(1-persp, 0, 0, 1, -100, 0);

  ctx.rotate(deg(bodyTilt));
  const bodyH=base*headRatio;
  const headR=base*0.5;
  // body
  ctx.beginPath();
  ctx.ellipse(0,0,headR*0.8,bodyH*0.6,0,0,Math.PI*2);
  ctx.stroke();

  // limbs
  function limb(x,y,len,ang){
    ctx.save();
    ctx.translate(x,y);
    ctx.rotate(deg(ang));
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.quadraticCurveTo(0,len*0.3,0,len);
    ctx.stroke();
    ctx.restore();
  }
  limb(-headR*0.9,-bodyH*0.2,bodyH*0.9,lArm);
  limb(headR*0.9,-bodyH*0.2,bodyH*0.9,rArm);
  limb(-headR*0.4,bodyH*0.6,bodyH*0.9,lLeg);
  limb(headR*0.4,bodyH*0.6,bodyH*0.9,rLeg);

  // head
  ctx.save();
  ctx.translate(0,-bodyH*0.9);
  ctx.rotate(deg(headTilt));
  ctx.beginPath();
  ctx.arc(0,0,headR,0,Math.PI*2);
  ctx.stroke();
  // face
  ctx.beginPath();
  ctx.moveTo(-headR*0.3,0);
  ctx.lineTo(-headR*0.1,0);
  ctx.moveTo(headR*0.3,0);
  ctx.lineTo(headR*0.1,0);
  ctx.moveTo(-headR*0.2,headR*0.3);
  ctx.quadraticCurveTo(0,headR*0.5,headR*0.2,headR*0.3);
  ctx.stroke();
  ctx.restore();

  ctx.restore();
}

['ratio','persp','view','lArm','rArm','lLeg','rLeg','headTilt','bodyTilt','lw'].forEach(id=>{
  $(id).addEventListener('input',drawCharacter);
});

drawCharacter();

// rotation animation
let running=false,angle=0,animID;
$('rotateBtn').onclick=()=>{
  if(running){cancelAnimationFrame(animID);running=false;$('rotateBtn').textContent='360° 회전 ▶';return;}
  running=true;$('rotateBtn').textContent='정지 ⏸';
  function spin(){
    angle=(angle+parseFloat($('speed').value))%360;
    ctx.save();
    ctx.clearRect(0,0,cv.width,cv.height);
    ctx.translate(512,512);
    ctx.rotate(deg(angle));
    ctx.translate(-512,-512);
    drawCharacter();
    ctx.restore();
    animID=requestAnimationFrame(spin);
  }
  spin();
};

// save png
$('saveBtn').onclick=()=>{
  drawCharacter();
  const a=document.createElement('a');
  a.download='character_'+Math.floor(rnd(9999))+'.png';
  a.href=cv.toDataURL('image/png');
  a.click();
};
</script>
</body>
</html>
